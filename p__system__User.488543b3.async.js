(self.webpackChunkgin_admin_frontend=self.webpackChunkgin_admin_frontend||[]).push([[915],{52688:function(J,A,e){"use strict";var a=e(22122),O=e(28991),x=e(81253),u=e(67294),P=e(46855),K=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],b=u.forwardRef(function(y,w){var M=y.fieldProps,Y=y.unCheckedChildren,d=y.checkedChildren,C=y.proFieldProps,U=(0,x.Z)(y,K);return u.createElement(P.Z,(0,a.Z)({valueType:"switch",mode:"edit",fieldProps:(0,O.Z)({unCheckedChildren:Y,checkedChildren:d},M),ref:w,valuePropName:"checked",proFieldProps:C,filedConfig:{valuePropName:"checked",ignoreWidth:!0}},U))});A.Z=b},5966:function(J,A,e){"use strict";var a=e(22122),O=e(81253),x=e(67294),u=e(46855),P=["fieldProps","proFieldProps"],K=["fieldProps","proFieldProps"],b="text",y=function(d){var C=d.fieldProps,U=d.proFieldProps,o=(0,O.Z)(d,P);return x.createElement(u.Z,(0,a.Z)({mode:"edit",valueType:b,fieldProps:C,filedConfig:{valueType:b},proFieldProps:U},o))},w=function(d){var C=d.fieldProps,U=d.proFieldProps,o=(0,O.Z)(d,K);return x.createElement(u.Z,(0,a.Z)({mode:"edit",valueType:"password",fieldProps:C,proFieldProps:U,filedConfig:{valueType:b}},o))},M=y;M.Password=w,M.displayName="ProFormComponent",A.Z=M},90672:function(J,A,e){"use strict";var a=e(22122),O=e(81253),x=e(67294),u=e(46855),P=["fieldProps","proFieldProps"],K=function(y,w){var M=y.fieldProps,Y=y.proFieldProps,d=(0,O.Z)(y,P);return x.createElement(u.Z,(0,a.Z)({ref:w,mode:"edit",valueType:"textarea",fieldProps:M,proFieldProps:Y},d))};A.Z=x.forwardRef(K)},55243:function(J,A,e){"use strict";e.d(A,{HS:function(){return re},IG:function(){return X},hC:function(){return ae},g2:function(){return q}});var a=e(62350),O=e(24565),x=e(22385),u=e(45777),P=e(11849),K=e(57663),b=e(71577),y=e(28991),w=e(67294),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},Y=M,d=e(27029),C=function(n,j){return w.createElement(d.Z,(0,y.Z)((0,y.Z)({},n),{},{ref:j,icon:Y}))};C.displayName="PlusCircleOutlined";var U=w.forwardRef(C),o=e(49101),E=e(1870),D=e(73171),k=e(8212),s=e(25377),z=e(51615),p=e(85893),re=function(n){var j=(0,s.tT)("@@initialState"),h=j.initialState,I=(0,s.YB)(),F=(0,z.$B)(),W=h.routePathCodeMap[F.path],$=h.flatMenus.hasOwnProperty("".concat(W,".add"));return(0,p.jsx)(p.Fragment,{children:$&&(0,p.jsx)(b.Z,(0,P.Z)((0,P.Z)({icon:(0,p.jsx)(o.Z,{}),type:"primary"},n),{},{title:void 0,children:n.title?n.title:I.formatMessage({id:"button.add"})}))})},X=function(n){var j=(0,s.tT)("@@initialState"),h=j.initialState,I=(0,s.YB)(),F=(0,z.$B)(),W=h.routePathCodeMap[F.path],$=h.flatMenus.hasOwnProperty("".concat(W,".add"));return(0,p.jsx)(p.Fragment,{children:$&&(0,p.jsx)(u.Z,{title:n.title?n.title:I.formatMessage({id:"button.add",defaultMessage:"\u6DFB\u52A0"}),children:(0,p.jsx)(b.Z,(0,P.Z)((0,P.Z)({size:"middle",shape:"circle",type:"link",icon:(0,p.jsx)(U,{}),style:{border:0}},n),{},{title:void 0}))})})},ae=function(n){var j,h=(0,s.tT)("@@initialState"),I=h.initialState,F=(0,z.$B)(),W=(0,s.YB)(),$=I.routePathCodeMap[F.path],se=I.flatMenus.hasOwnProperty("".concat($,".delete"));return(0,p.jsx)(p.Fragment,{children:se&&(0,w.createElement)(O.Z,(0,P.Z)((0,P.Z)({},n),{},{key:"delete",title:n.title,icon:(0,p.jsx)(E.Z,{style:{color:"red"}}),placement:"topLeft",onCancel:function(m){return m.stopPropagation()}}),(0,p.jsx)(u.Z,{title:(j=n.buttonProps)!==null&&j!==void 0&&j.title?n.buttonProps.title:W.formatMessage({id:"button.delete",defaultMessage:"\u5220\u9664"}),children:(0,p.jsx)(b.Z,(0,P.Z)((0,P.Z)({size:"middle",shape:"circle",danger:!0,icon:(0,p.jsx)(D.Z,{}),style:{border:0},onClick:function(m){return m.stopPropagation()}},n.buttonProps),{},{title:void 0}))}))})},q=function(n){var j=(0,s.tT)("@@initialState"),h=j.initialState,I=(0,s.YB)(),F=(0,z.$B)(),W=h.routePathCodeMap[F.path],$=h.flatMenus.hasOwnProperty("".concat(W,".edit"));return(0,p.jsx)(p.Fragment,{children:$&&(0,p.jsx)(u.Z,{title:n.title?n.title:I.formatMessage({id:"button.edit",defaultMessage:"\u7F16\u8F91"}),children:(0,p.jsx)(b.Z,(0,P.Z)((0,P.Z)({size:"middle",shape:"circle",type:"link",icon:n.icon?n.icon:(0,p.jsx)(k.Z,{}),style:{border:0}},n),{},{title:void 0}))})})},le=function(n){var j=useModel("@@initialState"),h=j.initialState,I=useIntl(),F=useRouteMatch(),W=h.routePathCodeMap[F.path],$=h.flatMenus.hasOwnProperty("".concat(W,".export"));return _jsx(_Fragment,{children:$&&_jsx(_Button,_objectSpread(_objectSpread({icon:_jsx(UploadOutlined,{}),type:"primary"},n),{},{title:void 0,children:n.title?n.title:I.formatMessage({id:"button.export",defaultMessage:"\u5BFC\u51FA"})}))})},te=function(n){var j=useModel("@@initialState"),h=j.initialState,I=useIntl(),F=useRouteMatch(),W=h.routePathCodeMap[F.path],$=h.flatMenus.hasOwnProperty("".concat(W,".import"));return _jsx(_Fragment,{children:$&&_jsx(_Button,_objectSpread(_objectSpread({icon:_jsx(ImportOutlined,{}),type:"primary"},n),{},{title:void 0,children:n.title?n.title:I.formatMessage({id:"button.import",defaultMessage:"\u5BFC\u5165"})}))})}},99226:function(J,A,e){"use strict";e.r(A),e.d(A,{default:function(){return pe}});var a=e(39428),O=e(34792),x=e(48086),u=e(3182),P=e(32059),K=e(49111),b=e(19650),y=e(71153),w=e(60331),M=e(2824),Y=e(67265),d=e(67294),C=e(25377),U=e(48265),o=e(11849);function E(c,r){return D.apply(this,arguments)}function D(){return D=(0,u.Z)((0,a.Z)().mark(function c(r,t){return(0,a.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,C.WY)("/api/v1/users",(0,o.Z)({method:"GET",params:(0,o.Z)({current:"1",pageSize:"10"},r)},t||{})));case 1:case"end":return i.stop()}},c)})),D.apply(this,arguments)}function k(c,r){return s.apply(this,arguments)}function s(){return s=(0,u.Z)((0,a.Z)().mark(function c(r,t){return(0,a.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,C.WY)("/api/v1/users",(0,o.Z)({method:"POST",data:r},t||{})));case 1:case"end":return i.stop()}},c)})),s.apply(this,arguments)}function z(c,r){return p.apply(this,arguments)}function p(){return p=(0,u.Z)((0,a.Z)().mark(function c(r,t){return(0,a.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,C.WY)("/api/v1/users/".concat(r),(0,o.Z)({method:"GET"},t||{})));case 1:case"end":return i.stop()}},c)})),p.apply(this,arguments)}function re(c,r,t){return X.apply(this,arguments)}function X(){return X=(0,u.Z)((0,a.Z)().mark(function c(r,t,T){return(0,a.Z)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,C.WY)("/api/v1/users/".concat(r),(0,o.Z)({method:"PUT",data:t},T||{})));case 1:case"end":return _.stop()}},c)})),X.apply(this,arguments)}function ae(c,r){return q.apply(this,arguments)}function q(){return q=(0,u.Z)((0,a.Z)().mark(function c(r,t){return(0,a.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,C.WY)("/api/v1/users/".concat(r),(0,o.Z)({method:"DELETE"},t||{})));case 1:case"end":return i.stop()}},c)})),q.apply(this,arguments)}function le(c,r){return te.apply(this,arguments)}function te(){return te=_asyncToGenerator(_regeneratorRuntime().mark(function c(r,t){return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",request("/api/v1/users/".concat(r,"/reset-pwd"),_objectSpread({method:"PATCH"},t||{})));case 1:case"end":return i.stop()}},c)})),te.apply(this,arguments)}var H=e(89032),n=e(15746),j=e(37476),h=e(5966),I=e(82785),F=e(90672),W=e(52688),$=e(43358),se=e(34041),ne=e(45562),m=e(85893),oe=function(r){var t=(0,d.useState)([]),T=(0,M.Z)(t,2),i=T[0],_=T[1],R=(0,d.useState)([]),V=(0,M.Z)(R,2),N=V[0],L=V[1];return(0,d.useEffect)(function(){var v=function(){var S=(0,u.Z)((0,a.Z)().mark(function g(f){var Z;return(0,a.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,ne.fp)(f);case 2:if(Z=l.sent,!Z.data){l.next=7;break}return l.abrupt("return",Z.data.map(function(Q){return{label:Q.name,value:Q.id}}));case 7:return l.abrupt("return",[]);case 8:case"end":return l.stop()}},g)}));return function(f){return S.apply(this,arguments)}}();v({status:"enabled",resultType:"select"}).then(function(S){_(S)})},[]),(0,d.useEffect)(function(){r.value?L(r.value.map(function(v){return v.role_id})):L([])},[r.value]),(0,m.jsx)(se.Z,(0,o.Z)((0,o.Z)({allowClear:!1,showSearch:!0,mode:"tags"},r),{},{options:i,value:N,onChange:function(S){L(S),r.onChange&&r.onChange(S.map(function(g){return{role_id:g}}))}}))},ue=oe,de=e(97470),ce=function(r){var t=(0,C.YB)(),T=(0,d.useRef)(),i=(0,d.useState)(),_=(0,M.Z)(i,2),R=_[0],V=_[1];return(0,d.useEffect)(function(){var N;!r.visible||((N=T.current)===null||N===void 0||N.resetFields(),r.id&&z(r.id).then(function(){var L=(0,u.Z)((0,a.Z)().mark(function v(S){var g,f;return(0,a.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:S.data&&(f=S.data,V(f),f.statusChecked=f.status==="activated",(g=T.current)===null||g===void 0||g.setFieldsValue(f));case 1:case"end":return B.stop()}},v)}));return function(v){return L.apply(this,arguments)}}()))},[r]),(0,m.jsxs)(j.Y,{visible:r.visible,title:r.title,width:800,formRef:T,layout:"horizontal",grid:!0,rowProps:{gutter:20},submitTimeout:3e3,submitter:{searchConfig:{submitText:t.formatMessage({id:"button.confirm"}),resetText:t.formatMessage({id:"button.cancel"})}},modalProps:{destroyOnClose:!0,maskClosable:!1,onCancel:function(){r.onCancel()}},onFinish:function(){var N=(0,u.Z)((0,a.Z)().mark(function L(v){var S,g,f,Z;return(0,a.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(v.status=v.statusChecked?"activated":"freezed",delete v.statusChecked,v.password=v.password?de.Z.md5(v.password):void 0,!r.id){l.next=24;break}if(!(R!=null&&R.roles)){l.next=20;break}S=v.roles,g=0;case 7:if(!(g<S.length)){l.next=19;break}f=0;case 9:if(!(f<(R==null||(Z=R.roles)===null||Z===void 0?void 0:Z.length))){l.next=16;break}if(S[g].role_id!==(R==null?void 0:R.roles[f].role_id)){l.next=13;break}return S[g].id=R==null?void 0:R.roles[f].id,l.abrupt("break",16);case 13:f++,l.next=9;break;case 16:g++,l.next=7;break;case 19:v.roles=S;case 20:return l.next=22,re(r.id,v);case 22:l.next=26;break;case 24:return l.next=26,k(v);case 26:return x.ZP.success(t.formatMessage({id:"component.message.success.save"})),r.onSuccess(),l.abrupt("return",!0);case 29:case"end":return l.stop()}},L)}));return function(L){return N.apply(this,arguments)}}(),initialValues:{statusChecked:!0},children:[(0,m.jsx)(h.Z,{name:"username",label:t.formatMessage({id:"pages.system.user.form.username"}),placeholder:t.formatMessage({id:"pages.system.user.form.username.placeholder"}),rules:[{required:!0,message:t.formatMessage({id:"pages.system.user.form.username.required"})}],colProps:{span:12}}),(0,m.jsx)(h.Z.Password,{name:"password",label:t.formatMessage({id:"pages.system.user.form.password"}),placeholder:r.id?t.formatMessage({id:"pages.system.user.form.password.update.placeholder"}):t.formatMessage({id:"pages.system.user.form.password.placeholder"}),colProps:{span:12}}),(0,m.jsx)(h.Z,{name:"name",label:t.formatMessage({id:"pages.system.user.form.name"}),placeholder:t.formatMessage({id:"pages.system.user.form.name.placeholder"}),rules:[{required:!0,message:t.formatMessage({id:"pages.system.user.form.name.required"})}],colProps:{span:12}}),(0,m.jsx)(n.Z,{span:12,children:(0,m.jsx)(I.Z,{name:"roles",label:t.formatMessage({id:"pages.system.user.form.roles"}),rules:[{required:!0,message:t.formatMessage({id:"pages.system.user.form.roles.required"})}],children:(0,m.jsx)(ue,{placeholder:t.formatMessage({id:"pages.system.user.form.roles.placeholder"})})})}),(0,m.jsx)(h.Z,{name:"email",label:t.formatMessage({id:"pages.system.user.form.email"}),placeholder:t.formatMessage({id:"pages.system.user.form.email.placeholder"}),colProps:{span:12}}),(0,m.jsx)(h.Z,{name:"phone",label:t.formatMessage({id:"pages.system.user.form.phone"}),placeholder:t.formatMessage({id:"pages.system.user.form.phone.placeholder"}),colProps:{span:12}}),(0,m.jsx)(F.Z,{name:"remark",label:t.formatMessage({id:"pages.system.user.form.remark"}),fieldProps:{rows:2},colProps:{span:24}}),(0,m.jsx)(W.Z,{name:"statusChecked",label:t.formatMessage({id:"pages.system.user.form.status"}),fieldProps:{checkedChildren:t.formatMessage({id:"pages.system.user.form.status.activated"}),unCheckedChildren:t.formatMessage({id:"pages.system.user.form.status.freezed"})},colProps:{span:12}})]})},me=ce,ie=e(55243),G;(function(c){c[c.ADD=0]="ADD",c[c.EDIT=1]="EDIT",c[c.CANCEL=2]="CANCEL"})(G||(G={}));var fe=function(){var r,t=(0,C.YB)(),T=(0,d.useRef)(),i=t.formatMessage({id:"pages.system.user.add"}),_=t.formatMessage({id:"pages.system.user.edit"}),R=t.formatMessage({id:"pages.system.user.delTip"}),V=(0,d.useReducer)(function(g,f){var Z;switch(f.type){case G.ADD:return{visible:!0,title:i};case G.EDIT:return{visible:!0,title:_,id:(Z=f.payload)===null||Z===void 0?void 0:Z.id};case G.CANCEL:return{visible:!1,title:"",id:void 0};default:return g}},{visible:!1,title:""}),N=(0,M.Z)(V,2),L=N[0],v=N[1],S=[{title:t.formatMessage({id:"pages.system.user.form.username"}),dataIndex:"username",width:160,key:"username"},{title:t.formatMessage({id:"pages.system.user.form.name"}),dataIndex:"name",ellipsis:!0,width:160,key:"name"},{title:t.formatMessage({id:"pages.system.user.form.roles"}),dataIndex:"roles",width:200,search:!1,render:function(f,Z){var B;return Z.roles?(0,m.jsx)(b.Z,{children:(B=Z.roles)===null||B===void 0?void 0:B.map(function(l){return(0,m.jsx)(w.Z,{color:"blue",children:l.role_name},l.role_id)})}):"-"}},{title:t.formatMessage({id:"pages.system.user.form.status"}),dataIndex:"status",width:130,key:"status",valueType:"select",valueEnum:(r={},(0,P.Z)(r,"activated",{text:t.formatMessage({id:"pages.system.user.form.status.activated"}),status:"Success"}),(0,P.Z)(r,"freezed",{text:t.formatMessage({id:"pages.system.user.form.status.freezed"}),status:"Error"}),r),render:function(f,Z){var B=Z.status;return(0,m.jsx)(w.Z,{color:B==="activated"?"success":"error",children:B==="activated"?t.formatMessage({id:"pages.system.user.form.status.activated"}):t.formatMessage({id:"pages.system.user.form.status.freezed"})})}},{title:t.formatMessage({id:"pages.system.user.form.created_at"}),dataIndex:"created_at",valueType:"dateTime",search:!1,width:180},{title:t.formatMessage({id:"pages.system.user.form.updated_at"}),dataIndex:"updated_at",valueType:"dateTime",search:!1,width:180},{title:t.formatMessage({id:"pages.table.column.operation"}),valueType:"option",key:"option",width:130,render:function(f,Z){return(0,m.jsxs)(b.Z,{size:2,children:[(0,m.jsx)(ie.g2,{onClick:function(){v({type:G.EDIT,payload:Z})}},"edit"),(0,m.jsx)(ie.hC,{title:R,onConfirm:(0,u.Z)((0,a.Z)().mark(function B(){var l,Q;return(0,a.Z)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,ae(Z.id);case 2:l=ee.sent,l.success&&(x.ZP.success(t.formatMessage({id:"component.message.success.delete"})),(Q=T.current)===null||Q===void 0||Q.reload());case 4:case"end":return ee.stop()}},B)}))},"delete")]})}}];return(0,m.jsxs)(Y.ZP,{children:[(0,m.jsx)(U.Z,{columns:S,actionRef:T,request:E,rowKey:"id",cardBordered:!0,search:{labelWidth:"auto"},pagination:{pageSize:10,showSizeChanger:!0},options:{density:!0,fullScreen:!0,reload:!0},dateFormatter:"string",toolBarRender:function(){return[(0,m.jsx)(ie.HS,{onClick:function(){v({type:G.ADD})}},"add")]}}),(0,m.jsx)(me,{visible:L.visible,title:L.title,id:L.id,onCancel:function(){v({type:G.CANCEL})},onSuccess:function(){var f;v({type:G.CANCEL}),(f=T.current)===null||f===void 0||f.reload()}})]})},pe=fe},45562:function(J,A,e){"use strict";e.d(A,{fp:function(){return P},_d:function(){return b},cY:function(){return w},ul:function(){return Y},k8:function(){return C}});var a=e(39428),O=e(11849),x=e(3182),u=e(25377);function P(o,E){return K.apply(this,arguments)}function K(){return K=(0,x.Z)((0,a.Z)().mark(function o(E,D){return(0,a.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,u.WY)("/api/v1/roles",(0,O.Z)({method:"GET",params:(0,O.Z)({current:"1",pageSize:"10"},E)},D||{})));case 1:case"end":return s.stop()}},o)})),K.apply(this,arguments)}function b(o,E){return y.apply(this,arguments)}function y(){return y=(0,x.Z)((0,a.Z)().mark(function o(E,D){return(0,a.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,u.WY)("/api/v1/roles",(0,O.Z)({method:"POST",data:E},D||{})));case 1:case"end":return s.stop()}},o)})),y.apply(this,arguments)}function w(o,E){return M.apply(this,arguments)}function M(){return M=(0,x.Z)((0,a.Z)().mark(function o(E,D){return(0,a.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,u.WY)("/api/v1/roles/".concat(E),(0,O.Z)({method:"GET"},D||{})));case 1:case"end":return s.stop()}},o)})),M.apply(this,arguments)}function Y(o,E,D){return d.apply(this,arguments)}function d(){return d=(0,x.Z)((0,a.Z)().mark(function o(E,D,k){return(0,a.Z)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.abrupt("return",(0,u.WY)("/api/v1/roles/".concat(E),(0,O.Z)({method:"PUT",data:D},k||{})));case 1:case"end":return z.stop()}},o)})),d.apply(this,arguments)}function C(o,E){return U.apply(this,arguments)}function U(){return U=(0,x.Z)((0,a.Z)().mark(function o(E,D){return(0,a.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,u.WY)("/api/v1/roles/".concat(E),(0,O.Z)({method:"DELETE"},D||{})));case 1:case"end":return s.stop()}},o)})),U.apply(this,arguments)}}}]);
