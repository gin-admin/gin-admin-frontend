(self.webpackChunkgin_admin_frontend=self.webpackChunkgin_admin_frontend||[]).push([[531],{5966:function(K,F,e){"use strict";var b=e(22122),I=e(81253),H=e(67294),N=e(46855),te=["fieldProps","proFieldProps"],z=["fieldProps","proFieldProps"],R="text",S=function(h){var f=h.fieldProps,t=h.proFieldProps,j=(0,I.Z)(h,te);return H.createElement(N.Z,(0,b.Z)({mode:"edit",valueType:R,fieldProps:f,filedConfig:{valueType:R},proFieldProps:t},j))},p=function(h){var f=h.fieldProps,t=h.proFieldProps,j=(0,I.Z)(h,z);return H.createElement(N.Z,(0,b.Z)({mode:"edit",valueType:"password",fieldProps:f,proFieldProps:t,filedConfig:{valueType:R}},j))},y=S;y.Password=p,y.displayName="ProFormComponent",F.Z=y},34687:function(K){K.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",icon:"icon___rzGKO"}},32384:function(){},7138:function(K,F,e){"use strict";e.r(F),e.d(F,{default:function(){return je}});var b=e(13062),I=e(71230),H=e(57663),N=e(71577),te=e(89032),z=e(15746),R=e(34792),S=e(48086),p=e(39428),y=e(11849),E=e(3182),h=e(2824),f=e(28991),t=e(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},de=j,ae=e(27029),re=function(u,P){return t.createElement(ae.Z,(0,f.Z)((0,f.Z)({},u),{},{ref:P,icon:de}))};re.displayName="LockOutlined";var ue=t.forwardRef(re),ce={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64L128 192v384c0 212.1 171.9 384 384 384s384-171.9 384-384V192L512 64zm312 512c0 172.3-139.7 312-312 312S200 748.3 200 576V246l312-110 312 110v330z"}},{tag:"path",attrs:{d:"M378.4 475.1a35.91 35.91 0 00-50.9 0 35.91 35.91 0 000 50.9l129.4 129.4 2.1 2.1a33.98 33.98 0 0048.1 0L730.6 434a33.98 33.98 0 000-48.1l-2.8-2.8a33.98 33.98 0 00-48.1 0L483 579.7 378.4 475.1z"}}]},name:"safety",theme:"outlined"},ve=ce,se=function(u,P){return t.createElement(ae.Z,(0,f.Z)((0,f.Z)({},u),{},{ref:P,icon:ve}))};se.displayName="SafetyOutlined";var fe=t.forwardRef(se),me=e(89366),ge=e(22122),Le=e(84305),he=e(39559),pe=e(81253),Ze=e(54787),Pe=e(5894),Ce=e(32384),ye=["logo","message","contentStyle","title","subTitle","actions","children"];function Me(m){var u=m.logo,P=m.message,M=m.contentStyle,C=m.title,d=m.subTitle,O=m.actions,G=m.children,i=(0,pe.Z)(m,ye),U=(0,Ze.YB)(),J=i.submitter===!1?!1:(0,f.Z)((0,f.Z)({searchConfig:{submitText:U.getMessage("loginForm.submitText","\u767B\u5F55")},submitButtonProps:{size:"large",style:{width:"100%"}}},i.submitter),{},{render:function(T,W){var g,s,r=W.pop();if((i==null||(g=i.submitter)===null||g===void 0?void 0:g.render)===void 0)return r;if(typeof(i==null||(s=i.submitter)===null||s===void 0?void 0:s.render)=="function"){var c,o;return i==null||(c=i.submitter)===null||c===void 0||(o=c.render)===null||o===void 0?void 0:o.call(c,T,W)}return r}}),Q=(0,t.useContext)(he.ZP.ConfigContext),A=Q.getPrefixCls("pro-form-login"),v=function(T){return"".concat(A,"-").concat(T)},x=(0,t.useMemo)(function(){return u?typeof u=="string"?t.createElement("img",{src:u}):u:null},[u]);return t.createElement("div",{className:v("container")},t.createElement("div",{className:v("top")},C||x?t.createElement("div",{className:v("header")},x?t.createElement("span",{className:v("logo")},x):null,C?t.createElement("span",{className:v("title")},C):null):null,d?t.createElement("div",{className:v("desc")},d):null),t.createElement("div",{className:v("main"),style:(0,f.Z)({width:328},M)},t.createElement(Pe.A,(0,ge.Z)({isKeyPressSubmit:!0},i,{submitter:J}),P,G),O?t.createElement("div",{className:v("other")},O):null))}var Y=e(5966),ne=e(60923),Z=e(25377),B=e(82566),xe=e(34687),L=e.n(xe),$=e(97470),Se=e(42122),a=e(85893),Ee=function(){var u,P=(0,Z.tT)("@@initialState"),M=P.initialState,C=P.setInitialState,d=(0,Z.YB)(),O=(0,t.useRef)(),G=(0,t.useState)(""),i=(0,h.Z)(G,2),U=i[0],J=i[1],Q=(0,t.useState)(""),A=(0,h.Z)(Q,2),v=A[0],x=A[1],V=function(){(0,B.lv)().then(function(s){if(s&&s.data&&s.data.captcha_id){var r=s.data.captcha_id;J(r),x((0,B.Bu)(r))}})};(0,t.useEffect)(function(){V()},[]);var T=function(){var g=(0,E.Z)((0,p.Z)().mark(function s(){var r,c;return(0,p.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M==null||(r=M.fetchInitData)===null||r===void 0?void 0:r.call(M);case 2:if(c=n.sent,!c){n.next=6;break}return n.next=6,C(function(D){return(0,y.Z)((0,y.Z)({},D),c)});case 6:case"end":return n.stop()}},s)}));return function(){return g.apply(this,arguments)}}(),W=function(){var g=(0,E.Z)((0,p.Z)().mark(function s(r){var c,o,n,D,X,w,k,le,ie,oe,q,_,ee;return(0,p.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return o=d.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25"}),l.prev=1,r.captcha_id=U,r.password=$.Z.md5(r.password),l.next=6,(0,B.x4)((0,y.Z)({},r));case 6:if(n=l.sent,!n.success){l.next=19;break}return S.ZP.success(d.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F"})),$.Z.setUsername(r.username),(D=n.data)!==null&&D!==void 0&&D.access_token&&$.g.setToken((X=n.data)===null||X===void 0?void 0:X.access_token,(w=n.data)===null||w===void 0?void 0:w.token_type,(k=n.data)===null||k===void 0?void 0:k.expires_at),l.next=13,T();case 13:if(Z.m8){l.next=15;break}return l.abrupt("return");case 15:return le=Z.m8.location.query,ie=le,oe=ie.redirect,Z.m8.push(oe||"/"),l.abrupt("return");case 19:n.error&&(o=((q=n.error)===null||q===void 0?void 0:q.detail)||""),S.ZP.error(o),l.next=28;break;case 23:l.prev=23,l.t0=l.catch(1),_=l.t0,_.data.error&&(o=((ee=_.data.error)===null||ee===void 0?void 0:ee.detail)||""),S.ZP.error(o);case 28:(c=O.current)===null||c===void 0||c.resetFields(["captcha_code"]),V();case 30:case"end":return l.stop()}},s,null,[[1,23]])}));return function(r){return g.apply(this,arguments)}}();return(0,a.jsxs)("div",{className:L().container,children:[(0,a.jsx)(Z.ql,{children:(0,a.jsxs)("title",{children:[d.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55"}),"- ",ne.Z.title]})}),(0,a.jsx)("div",{className:L().lang,"data-lang":!0,children:Z.pD&&(0,a.jsx)(Z.pD,{})}),(0,a.jsx)("div",{className:L().content,children:(0,a.jsxs)(Me,{formRef:O,logo:(0,a.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:(u=ne.Z.title)===null||u===void 0?void 0:u.toString(),subTitle:d.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{login_name:$.Z.getUsername()},actions:null,submitter:{searchConfig:{submitText:d.formatMessage({id:"pages.login.submit",defaultMessage:"\u767B\u5F55"})}},onFinish:function(){var g=(0,E.Z)((0,p.Z)().mark(function s(r){return(0,p.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,W(r);case 2:case"end":return o.stop()}},s)}));return function(s){return g.apply(this,arguments)}}(),children:[(0,a.jsx)(Y.Z,{name:"username",fieldProps:{size:"large",prefix:(0,a.jsx)(me.Z,{className:L().prefixIcon})},placeholder:d.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}),rules:[{required:!0,message:d.formatMessage({id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,a.jsx)(Y.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,a.jsx)(ue,{className:L().prefixIcon})},placeholder:d.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801"}),rules:[{required:!0,message:d.formatMessage({id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]}),(0,a.jsxs)(I.Z,{justify:"space-between",gutter:8,children:[(0,a.jsx)(z.Z,{span:17,children:(0,a.jsx)(Y.Z,{fieldProps:{size:"large",prefix:(0,a.jsx)(fe,{})},placeholder:d.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),name:"captcha_code",rules:[{required:!0,message:d.formatMessage({id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}]})}),(0,a.jsx)(z.Z,{span:7,children:(0,a.jsx)(N.Z,{loading:!v,style:{height:40,width:"100%",padding:0,overflow:"hidden"},onClick:function(){x((0,B.Bu)(U))},children:v&&(0,a.jsx)("img",{src:"".concat(Se.M).concat(v),alt:"",style:{width:"100%",height:"100%"}})})})]})]})})]})},je=Ee}}]);
